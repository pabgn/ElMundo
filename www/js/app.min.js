!function(o,a){"use strict";a.app=o.module("em",["ionic"]).run(["$ionicPlatform",function(o){o.ready(function(){a.cordova&&a.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),a.StatusBar&&StatusBar.styleDefault()})}]).value("endpoint","http://localhost:3001").value("filesEndpoint","http://localhost:3001/file/")}(angular,window);
var Suaip=function(e,t){"use strict";var a,i,n=200,r=300,s=2,c={},d={},o=!1,l=0,v=!1,f=function(e){if(!(e&&e.after&&e.active&&e.scope))throw"Invalid config";a=document.body.classList,i=e.scope,i.$apply(function(){i.nextLevel=y}),e.active.classList.add("active"),e.after.classList.add("after"),e.left&&e.left.classList.add("left"),e.right&&e.right.classList.add("right"),m(e.active,e.after,e.left,e.right),g()},g=function(){c=new e(d.active,{preventDefault:!1}),0!==i.level&&c.on("dragdown",L),c.on("dragend",w),d.left&&i.canGoNext()&&c.on("dragleft",h),d.right&&i.canGoPrev()&&c.on("dragright",p);for(var t in d)d[t].removeEventListener("touchstart",k)},u=function(){0!==i.level&&c.off("dragdown",L),c.off("dragend",w),d.left&&i.canGoNext()&&c.off("dragleft",h),d.right&&i.canGoPrev()&&c.off("dragright",p);for(var e in d)d[e].addEventListener("touchstart",k,!1)},m=function(e,t,a,n){d.active=e?e:document.getElementsByClassName("active")[0],d.after=1===i.level?document.getElementsByClassName("before")[0]:t?t:document.getElementsByClassName("after")[0],d.left=a?a:document.getElementsByClassName("left")[0],d.right=n?n:document.getElementsByClassName("right")[0]},h=function(e){if(!v){G(d.active,-e.gesture.distance,l,0);{Math.round(e.gesture.distance/d.active.scrollWidth*100)}G(d.right,d.active.scrollWidth-e.gesture.distance,0,0)}},p=function(e){if(!v){G(d.active,e.gesture.distance,l,0);{Math.round(e.gesture.distance/d.active.scrollWidth*100)}G(d.left,-(d.active.scrollWidth-e.gesture.distance),0,0)}},L=function(e){Math.round((l+e.gesture.distance)/t.innerHeight*100);G(d.active,0,l+e.gesture.distance,0),G(d.after,0,-(t.innerHeight-(e.gesture.distance+l)),0),v=!0},y=function(){u(),N(n),o="up",W()},w=function(e){o=e.gesture.direction,u();var t=e.gesture.velocityY>s?r:n;N(t),v=!1,"down"===o&&1===i.level?B(e):"left"===o&&i.canGoNext()?C(e):"right"===o&&i.canGoPrev()?H(e):(b(),g())},E=function(){d.active.classList.remove("animate"),["animate","dragup-reset","drag-complete","dragup-complete","dragdown-reset","dragdown-complete","dragleft-complete","dragright-complete"].forEach(function(e){a.remove(e)});for(var e in d)d[e].style.transition="",d[e].style.transform=d[e].style.webkitTransform="",d[e].style.opacity="";"up"===o&&i.enterRead(),d.active.removeEventListener("transitionend",E,!1),d.active.classList.contains("drag-complete")&&x(),m(),g()},x=function(){var e=d.active.classList,t=d.after.classList,a=d.left.classList,i=d.right.classList;e.remove("active"),e.remove("drag-complete"),"up"===o?(e.add("before"),t.remove("after"),t.add("active")):"down"===o?(e.add("after"),t.remove("before"),t.add("active")):"left"===o?(i.remove("right"),i.add("active"),e.add("left"),a.remove("left"),a.add("right")):(a.remove("left"),a.add("active"),e.add("right"),i.remove("right"),i.add("left"))},N=function(e){d.active.classList.add("animate");for(var t in d)d[t].style.transition="all "+e+"ms ease"},b=function(){t.setTimeout(function(){d.active.classList.remove("animate");for(var e in d)d[e].style.transition=""},400)},G=function(e,t,a,i){var n="translate3d("+t+"px,"+a+"px,"+i+"px)";e.style.transform=e.style.webkitTransform=n},W=function(){i.level=1,l=0,a.add("dragup-complete"),d.active.classList.add("drag-complete"),d.active.addEventListener("transitionend",E,!1)},B=function(e){l+=e.gesture.distance,l<t.innerHeight/6*2?(l>0&&(l=0,G(d.active,0,0,0)),g(),b()):(i.$apply(function(){i.level=0,i.back()}),l=0,a.add("dragdown-complete"),d.active.classList.add("drag-complete"),d.active.addEventListener("transitionend",E,!1))},C=function(e){e.gesture.distance<t.innerWidth/3?(G(d.active,0,l,0),g(),b()):(i.sectionIndex[i.level]++,i.next(),a.add("dragleft-complete"),d.active.classList.add("drag-complete"),d.active.addEventListener("transitionend",E,!1))},H=function(e){e.gesture.distance<t.innerWidth/3?(G(d.active,0,l,0),g(),b()):(i.sectionIndex[i.level]--,i.prev(),a.add("dragright-complete"),d.active.classList.add("drag-complete"),d.active.addEventListener("transitionend",E,!1))},k=function(e){e.preventDefault()};return{init:f}}(Hammer,window);
!function(e,t){"use strict";e.controller("CardGridCtrl",["$scope","newsService",function(e,n){e.level=0,e.sectionIndex=[1,0],e.selectedCategory=0,e.showIntro=!0,e.userCategories=JSON.parse(localStorage.getItem("user_preferences")),e.news={},e.selectedCategories={},e.categories=[{icon:"home",title:"España",url:"espana"},{icon:"bubble",title:"Opinión",url:"opinion"},{icon:"globe",title:"Internacional",url:"internacional"},{icon:"bars",title:"Economía",url:"economia"},{icon:"football",title:"Deportes",url:"deportes"},{icon:"book",title:"Cultura",url:"cultura"},{icon:"rocket",title:"Ciencia",url:"ciencia"},{icon:"tv2",title:"Televisión",url:"television"},{icon:"heart",title:"Salud",url:"salud"}],e.categoriesName={salud:"Salud",ciencia:"Ciencia",economia:"Economía",television:"Televisión",cultura:"Cultura",deportes:"Deportes",internacional:"Internacional",opinion:"Opinión",espana:"España"};var r=1;e.getCurrentNews=function(){return e.news[e.userCategories[e.selectedCategory]].news},e.iconForCategory=function(e){var t={};return t["icon-"+e.icon]=!0,t},e.selectCategory=function(t,n){var r=Object.keys(e.selectedCategories).map(function(t){return e.selectedCategories[t]}).filter(function(e){return e}).length;r>=3&&(t.preventDefault(),t.stopPropagation(),e.selectedCategories[n]=!1)},e.loadUserCategories=function(){for(var t=0,r=e.userCategories.length;r>t;t++)!function(t,r){n.getCategory(e.userCategories[t]).then(function(n){e.news[e.userCategories[t]]=n,t===r-1&&localStorage.setItem("news",JSON.stringify(e.news))})}(t,r)},e.loadNews=function(){var t=localStorage.getItem("news");t?e.news=JSON.parse(t):e.loadUserCategories()},e.userCategories&&(e.showIntro=!1,e.loadNews()),e.selectCategories=function(){var t=Object.keys(e.selectedCategories).map(function(t){return e.selectedCategories[t]?t:""}).filter(function(e){return""!==e});localStorage.setItem("user_preferences",JSON.stringify(t)),e.userCategories=t,e.loadNews(),e.showIntro=!1},e.canGoNext=function(){var t=e.sectionIndex[e.level];return e.news&&e.userCategories&&t<e.news[e.userCategories[e.selectedCategory]].news.length-1},e.canGoPrev=function(){return e.sectionIndex[e.level]>0},e.getCurrentArticle=function(){var t=e.sectionIndex[e.level];return e.news&&e.userCategories?e.news[e.userCategories[e.selectedCategory]].news[t]:{}},e.getPrevArticle=function(){if(e.canGoPrev()){var t=e.sectionIndex[e.level];return e.news[e.userCategories[e.selectedCategory]].news[t-1]}return{}},e.getNextArticle=function(){if(e.canGoNext()){var t=e.sectionIndex[e.level];return e.news[e.userCategories[e.selectedCategory]].news[t+1]}return{}},e.getCategory=function(){return e.userCategories?e.categoriesName[e.userCategories[e.selectedCategory]]:""},e.prev=function(){r--,0>r&&(r=2),e.$digest()},e.next=function(){r++,r>2&&(r=0),e.$digest()},e.articleForCenter=function(){return 1===r?e.getCurrentArticle():r>1?e.getPrevArticle():e.getNextArticle()},e.articleForLeft=function(){return 0===r?e.getCurrentArticle():2===r?e.getNextArticle():e.getPrevArticle()},e.articleForRight=function(){return 2===r?e.getCurrentArticle():0===r?e.getPrevArticle():e.getNextArticle()},e.showCenter=function(){return 1===r?1===e.level&&e.news:r>1?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.showLeft=function(){return 0===r?1===e.level&&e.news:1===r?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.showRight=function(){return 2===r?1===e.level&&e.news:0===r?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.back=function(){},e.enterRead=function(){},window.addEventListener("DOMContentLoaded",function(){t.init({active:document.getElementById("top"),after:document.getElementById("read"),left:document.getElementById("left"),right:document.getElementById("right"),scope:e})})}])}(window.app,window.Suaip);
!function(e){"use strict";e.directive("newsTpl",function(){return{restrict:"E",scope:{news:"=news",category:"=category"},templateUrl:"templates/news.html",controller:["$scope","filesEndpoint",function(e,t){e.getImage=function(){return e.news&&e.news.media?t+e.news.media[0].url:""},e.hasImage=function(){return""!==e.getImage()},e.getTitle=function(){return e.news.title.split("|")[1]?e.news.title.split("|")[1].trim():""}}]}})}(window.app);
!function(e){"use strict";e.directive("newsListTpl",function(){return{restrict:"E",scope:{category:"=category",newsList:"=newsList"},templateUrl:"templates/news-list.html",controller:["$scope","filesEndpoint","$sce",function(e,t){e.hasImage=function(e){return e.media&&e.media.length>0},e.newsTitle=function(e){return e.title.split("|")[1]?e.title.split("|")[1].trim():""},e.newsContent=function(e){return e.content},e.newsImage=function(e){return e.media?t+e.media[0].url:""},e.readNews=function(t){e.$parent.sectionIndex[1]=t,e.$parent.nextLevel()}}]}})}(window.app);
!function(e){"use strict";e.service("newsService",["$q","$http","endpoint",function(e,n,t){var r=function(r){var i=e.defer();return n.get(t+"/categories/"+r).then(function(e){i.resolve(e.data)},function(){i.resolve({news:[]})}),i.promise};return{getCategory:r}}])}(window.app);