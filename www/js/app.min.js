!function(o,a){"use strict";a.app=o.module("em",["ionic","ionic.contrib.ui.cards"]).run(["$ionicPlatform",function(o){o.ready(function(){a.cordova&&a.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),a.StatusBar&&StatusBar.styleDefault()})}]).value("endpoint","http://178.62.30.80:3001").value("filesEndpoint","http://localhost:3001/file/")}(angular,window);
var Suaip=function(e,t){"use strict";var a,r,i=200,n=300,o=2,s={},c={},d=!1,l=0,v=!1,f=function(e){if(!(e&&e.after&&e.active&&e.scope))throw"Invalid config";a=document.body.classList,r=e.scope,r.$apply(function(){r.nextLevel=y,r.prevLevel=E}),e.active.classList.add("active"),e.after.classList.add("after"),e.left&&e.left.classList.add("left"),e.right&&e.right.classList.add("right"),u(e.active,e.after,e.left,e.right),m()},m=function(){s=new e(c.active,{preventDefault:!1}),0!==r.level&&s.on("dragdown",L),s.on("dragend",b),c.left&&r.canGoNext()&&s.on("dragleft",h),c.right&&r.canGoPrev()&&s.on("dragright",p);for(var t in c)c[t].removeEventListener("touchstart",H)},g=function(){0!==r.level&&s.off("dragdown",L),s.off("dragend",b),c.left&&r.canGoNext()&&s.off("dragleft",h),c.right&&r.canGoPrev()&&s.off("dragright",p);for(var e in c)c[e].addEventListener("touchstart",H,!1)},u=function(e,t,a,i){c.active=e?e:document.getElementsByClassName("active")[0],c.after=1===r.level?document.getElementsByClassName("before")[0]:t?t:document.getElementsByClassName("after")[0],c.left=a?a:document.getElementsByClassName("left")[0],c.right=i?i:document.getElementsByClassName("right")[0]},h=function(e){if(!v){N(c.active,-e.gesture.distance,l,0);{Math.round(e.gesture.distance/c.active.scrollWidth*100)}N(c.right,c.active.scrollWidth-e.gesture.distance,0,0)}},p=function(e){if(!v){N(c.active,e.gesture.distance,l,0);{Math.round(e.gesture.distance/c.active.scrollWidth*100)}N(c.left,-(c.active.scrollWidth-e.gesture.distance),0,0)}},L=function(e){Math.round((l+e.gesture.distance)/t.innerHeight*100);N(c.active,0,l+e.gesture.distance,0),N(c.after,0,-(t.innerHeight-(e.gesture.distance+l)),0),v=!0},y=function(){g(),I(i),d="up",C()},E=function(){g(),I(n),d="down",G({gesture:{distance:t.innerHeight},manual:!0})},b=function(e){d=e.gesture.direction,g();var t=e.gesture.velocityY>o?n:i;I(t),v=!1,"down"===d&&1===r.level?e.manual?(x(),m()):G(e):"left"===d&&r.canGoNext()?W(e):"right"===d&&r.canGoPrev()?$(e):(x(),m())},w=function(){c.active.classList.remove("animate"),["animate","dragup-reset","drag-complete","dragup-complete","dragdown-reset","dragdown-complete","dragleft-complete","dragright-complete"].forEach(function(e){a.remove(e)});for(var e in c)c[e].style.transition="",c[e].style.transform=c[e].style.webkitTransform="",c[e].style.opacity="";"up"===d&&r.enterRead(),c.active.removeEventListener("transitionend",w,!1),c.active.classList.contains("drag-complete")&&B(),u(),m()},B=function(){var e=c.active.classList,t=(c.after.classList,c.left.classList),a=c.right.classList;if(e.remove("active"),e.remove("drag-complete"),"up"===d){var i=document.getElementById("top").classList;i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("before"),i=document.getElementById("left").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("left"),i=document.getElementById("right").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("right"),i=document.getElementById("read").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("active"),r.$apply(function(){r.activeCard=1})}else if("down"===d){var i=document.getElementById("top").classList;i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("active"),i=document.getElementById("left").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("left"),i=document.getElementById("right").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("right"),i=document.getElementById("read").classList,i.remove("active"),i.remove("left"),i.remove("right"),i.remove("before"),i.remove("after"),i.add("after"),r.$apply(function(){r.activeCard=1})}else"left"===d?(a.remove("right"),a.add("active"),e.add("left"),t.remove("left"),t.add("right")):(t.remove("left"),t.add("active"),e.add("right"),a.remove("right"),a.add("left"))},I=function(e){c.active.classList.add("animate");for(var t in c)c[t].style.transition="all "+e+"ms ease"},x=function(){t.setTimeout(function(){c.active.classList.remove("animate");for(var e in c)c[e].style.transition=""},400)},N=function(e,t,a,r){var i="translate3d("+t+"px,"+a+"px,"+r+"px)";e.style.transform=e.style.webkitTransform=i},C=function(){r.level=1,l=0,a.add("dragup-complete"),c.active.classList.add("drag-complete"),c.active.addEventListener("transitionend",w,!1)},G=function(e){l+=e.gesture.distance,l<t.innerHeight/6*2?(l>0&&(l=0,N(c.active,0,0,0)),m(),x()):(r.$$phase?(r.level=0,r.back()):r.$apply(function(){r.level=0,r.back()}),l=0,a.add("dragdown-complete"),c.active.classList.add("drag-complete"),c.active.addEventListener("transitionend",w,!1))},W=function(e){e.gesture.distance<t.innerWidth/3?(N(c.active,0,l,0),m(),x()):(r.sectionIndex[r.level]++,r.next(),a.add("dragleft-complete"),c.active.classList.add("drag-complete"),c.active.addEventListener("transitionend",w,!1))},$=function(e){e.gesture.distance<t.innerWidth/3?(N(c.active,0,l,0),m(),x()):(r.sectionIndex[r.level]--,r.prev(),a.add("dragright-complete"),c.active.classList.add("drag-complete"),c.active.addEventListener("transitionend",w,!1))},H=function(e){e.preventDefault()};return{init:f}}(Hammer,window);
!function(e,t){"use strict";e.controller("CardGridCtrl",["$scope","newsService",function(e,r){e.level=0,e.sectionIndex=[1,0],e.selectedCategory=0,e.showIntro=!0,e.showPager=!0,e.userCategories=JSON.parse(localStorage.getItem("user_preferences"))||[],e.news={},e.selectedCategories={},e.categories=[{icon:"home",title:"España",url:"espana"},{icon:"bubble",title:"Opinión",url:"opinion"},{icon:"globe",title:"Internacional",url:"internacional"},{icon:"bars",title:"Economía",url:"economia"},{icon:"football",title:"Deportes",url:"deportes"},{icon:"book",title:"Cultura",url:"cultura"},{icon:"rocket",title:"Ciencia",url:"ciencia"},{icon:"tv2",title:"Televisión",url:"television"},{icon:"heart",title:"Salud",url:"salud"}],e.categoriesName={salud:"Salud",ciencia:"Ciencia",economia:"Economía",television:"Televisión",cultura:"Cultura",deportes:"Deportes",internacional:"Internacional",opinion:"Opinión",espana:"España"},e.activeCard=1,e.newsForCategory=function(t){return e.news[e.userCategories[t]]?e.news[e.userCategories[t]].news:null},e.iconForCategory=function(e){var t={};return t["icon-"+e.icon]=!0,t},e.selectCategory=function(t,r){var a=Object.keys(e.selectedCategories).map(function(t){return e.selectedCategories[t]}).filter(function(e){return e}).length;a>=3&&(t.preventDefault(),t.stopPropagation(),e.selectedCategories[r]=!1)},e.loadUserCategories=function(){for(var t=0,a=e.userCategories.length;a>t;t++)!function(t,a){r.getCategory(e.userCategories[t]).then(function(r){e.news[e.userCategories[t]]=r,t===a-1&&localStorage.setItem("news",JSON.stringify(e.news))})}(t,a)},e.loadNews=function(){var t=localStorage.getItem("news");t?e.news=JSON.parse(t):e.loadUserCategories()},e.userCategories.length>0&&(e.showIntro=!1,e.loadNews()),e.$watch("level",function(t){e.showPager=0===t}),e.selectCategories=function(){var t=Object.keys(e.selectedCategories).map(function(t){return e.selectedCategories[t]?t:""}).filter(function(e){return""!==e});localStorage.setItem("user_preferences",JSON.stringify(t)),e.userCategories=t,e.loadNews(),e.showIntro=!1},e.canGoNext=function(){if(0===e.level)return e.selectedCategory<e.userCategories.length-1;var t=e.sectionIndex[e.level];return e.news&&e.userCategories&&t<e.news[e.userCategories[e.selectedCategory]].news.length-1},e.canGoPrev=function(){return 0===e.level?e.selectedCategory>-1:e.sectionIndex[e.level]>0},e.getCurrentArticle=function(){var t=e.sectionIndex[e.level];return e.news&&e.userCategories?e.news[e.userCategories[e.selectedCategory]].news[t]:{}},e.getPrevArticle=function(){if(e.canGoPrev()){var t=e.sectionIndex[e.level];return e.news[e.userCategories[e.selectedCategory]].news[t-1]}return{}},e.getNextArticle=function(){if(e.canGoNext()){var t=e.sectionIndex[e.level];return e.news[e.userCategories[e.selectedCategory]].news[t+1]}return{}},e.getCategory=function(){return e.userCategories?e.categoriesName[e.userCategories[e.selectedCategory]]:""},e.prev=function(){e.activeCard--,0===e.level&&e.selectedCategory--,e.activeCard<0&&(e.activeCard=2),e.$digest()},e.next=function(){e.activeCard++,0===e.level&&e.selectedCategory++,e.activeCard>2&&(e.activeCard=0),e.$digest()},e.articleForCenter=function(){return 1===e.activeCard?e.getCurrentArticle():e.activeCard>1?e.getPrevArticle():e.getNextArticle()},e.articleForLeft=function(){return 0===e.activeCard?e.getCurrentArticle():2===e.activeCard?e.getNextArticle():e.getPrevArticle()},e.articleForRight=function(){return 2===e.activeCard?e.getCurrentArticle():0===e.activeCard?e.getPrevArticle():e.getNextArticle()},e.getNewsForCenter=function(){return e.newsForCategory(1===e.activeCard?e.selectedCategory:e.activeCard>1?e.selectedCategory-1:e.selectedCategory+1)},e.getNewsForLeft=function(){return e.newsForCategory(0===e.activeCard?e.selectedCategory:2===e.activeCard?e.selectedCategory+1:e.selectedCategory-1)},e.getNewsForRight=function(){return e.newsForCategory(2===e.activeCard?e.selectedCategory:0===e.activeCard?e.selectedCategory-1:e.selectedCategory+1)},e.getCategoryForCenter=function(){return 1===e.activeCard?e.categoriesName[e.userCategories[e.selectedCategory]]:e.activeCard>1?e.categoriesName[e.userCategories[e.selectedCategory-1]]:e.categoriesName[e.userCategories[e.selectedCategory+1]]},e.getCategoryForLeft=function(){return 0===e.activeCard?e.categoriesName[e.userCategories[e.selectedCategory]]:1===e.activeCard?e.categoriesName[e.userCategories[e.selectedCategory-1]]:e.categoriesName[e.userCategories[e.selectedCategory+1]]},e.getCategoryForRight=function(){return 2===e.activeCard?e.categoriesName[e.userCategories[e.selectedCategory]]:0===e.activeCard?e.categoriesName[e.userCategories[e.selectedCategory-1]]:e.categoriesName[e.userCategories[e.selectedCategory+1]]},e.showTopCenter=function(){return 1===e.activeCard?0===e.level:e.activeCard>1?0===e.level&&e.canGoPrev():0===e.level&&e.canGoNext()},e.showTopLeft=function(){return 0===e.activeCard?0===e.level:1===e.activeCard?0===e.level&&e.canGoPrev():0===e.level&&e.canGoNext()},e.showTopRight=function(){return 2===e.activeCard?0===e.level:0===e.activeCard?0===e.level&&e.canGoPrev():0===e.level&&e.canGoNext()},e.showCenter=function(){return 1===e.activeCard?!(1!==e.level||!e.news):e.activeCard>1?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.showLeft=function(){return 0===e.activeCard?1===e.level&&e.news:1===e.activeCard?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.showRight=function(){return 2===e.activeCard?1===e.level&&e.news:0===e.activeCard?1===e.level&&e.canGoPrev():1===e.level&&e.canGoNext()},e.back=function(){e.activeCard=1},e.enterRead=function(){e.activeCard=1,e.$digest()},e.$on("gotoPrevLevel",function(){e.prevLevel()}),e.cards=[],e.cardDestroyed=function(){},e.cardSwiped=function(){},window.addEventListener("DOMContentLoaded",function(){t.init({active:document.getElementById("top"),after:document.getElementById("read"),left:document.getElementById("left"),right:document.getElementById("right"),scope:e})})}])}(window.app,window.Suaip);
!function(e){"use strict";e.directive("newsTpl",function(){return{restrict:"E",scope:{news:"=news",category:"=category"},templateUrl:"templates/news.html",controller:["$scope",function(e){e.getImage=function(){return e.news&&e.news.media?e.news.media[0].url:""},e.hasImage=function(){return""!==e.getImage()},e.prevLevel=function(){e.$emit("gotoPrevLevel",{})},e.getTitle=function(){return e.news.title.split("|")[1]?e.news.title.split("|")[1].trim():""}}]}})}(window.app);
!function(t){"use strict";t.directive("newsListTpl",function(){return{restrict:"E",scope:{category:"=category",newsList:"=newsList"},templateUrl:"templates/news-list.html",controller:["$scope",function(t){t.hasImage=function(t){return t.media&&t.media.length>0},t.newsTitle=function(t){return t.title.split("|")[1]?t.title.split("|")[1].trim():""},t.newsContent=function(t){return t.content},t.newsImage=function(t){return t.media?t.media[0].url:""},t.readNews=function(e){t.$parent.sectionIndex[1]=e,t.$parent.nextLevel()}}]}})}(window.app);
!function(e){"use strict";e.service("newsService",["$q","$http","endpoint",function(e,n,t){var r=function(r){var i=e.defer();return n.get(t+"/categories/"+r).then(function(e){i.resolve(e.data)},function(){i.resolve({news:[]})}),i.promise};return{getCategory:r}}])}(window.app);